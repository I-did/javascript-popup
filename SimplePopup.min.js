(function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.SimplePopup=a()})(function(){let a=function(){return function(a){let b,c,d,e=this;return e.options=b=a,e.defaults=c={popup:"",overlay:"",openBtn:"",closeBtn:"",scrollThreshold:100,esc:!0},e.initials=d={$popup:null,$overlay:null,$closeBtn:null,$openBtn:null},e.assign(c,b),e.assign(d,e),e.init(),e.$popup.ctx=e,e.$popup}}();return a.prototype.assign=function(a,b){for(let c in a)void 0===b[c]&&(b[c]=a[c])},a.prototype.init=function(){let a=this,b=a.options,c=["popup","overlay","openBtn","closeBtn"];for(let d,e=0;e<c.length;e++)d="$"+c[e],!1!==a[d]&&""!==b[c[e]]&&(a[d]=document["querySelector"+(2===e?"All":"")](b[c[e]]),1>=e&&(a[c[e]+"Animation"]=window.getComputedStyle(a[d]).animation||b[c[e]+"Animation"],a[c[e]+"AnimationName"]=window.getComputedStyle(a[d]).animationName||b[c[e]+"AnimationName"]));a.openPopupHandler={handleEvent:a.openPopup,ctx:a},a.closePopupHandler={handleEvent:a.closePopup,ctx:a},a.$popup.open=a.openPopup,a.$popup.close=a.closePopup,a.initEvents()},a.prototype.initEvents=function(){let a=this;for(let b=0;b<a.$openBtn.length;b++)a.$openBtn[b].addEventListener("click",a.openPopupHandler);a.$closeBtn&&a.$closeBtn.addEventListener("click",a.closePopupHandler),a.initAnimationEndEvents(a,"popup"),a.initAnimationEndEvents(a,"overlay");let b=new CustomEvent("init");a.$popup.dispatchEvent(b)},a.prototype.initAnimationEndEvents=function(a,b){let c="$"+b;a[c]&&a[c].addEventListener("animationend",function(){if(event.animationName===a[b+"AnimationName"]){if(this.style.animation="",this.classList.remove("active"),"popup"===b){let b=new CustomEvent("close");a[c].dispatchEvent(b)}}else if(event.animationName!==a[b+"AnimationName"]&&"popup"===b){let b=new CustomEvent("open");a[c].dispatchEvent(b)}})},a.prototype.openPopup=function(){let a=this.ctx||this;if(a.$popup.caller=event&&event.currentTarget,!a.$popup.classList.contains("active")){a.$popup.classList.add("active"),a.pageY=pageYOffset,a.$overlay&&(a.$overlay.classList.add("active"),a.$overlay.addEventListener("click",a.closePopupHandler)),a.options.esc&&document.addEventListener("keyup",a.closePopupHandler),document.addEventListener("scroll",a.closePopupHandler);let b=new CustomEvent("beforeopen");a.$popup.dispatchEvent(b)}},a.prototype.closePopup=function(){if(!(event&&"keyup"===event.type&&27!==event.keyCode)){let a=this.ctx||this;if(!(event&&"scroll"===event.type&&pageYOffset-a.pageY<=a.options.scrollThreshold)){a.$popup.classList.contains("active")&&(a.$popup.style.animation=a.popupAnimation,a.$overlay&&(a.$overlay.style.animation=a.overlayAnimation)),a.options.esc&&document.removeEventListener("keyup",a.closePopupHandler),a.$overlay&&a.$overlay.removeEventListener("click",a.closePopupHandler),document.removeEventListener("scroll",a.closePopupHandler);let b=new CustomEvent("beforeclose");a.$popup.dispatchEvent(b)}}},a});